
# This file is generated by update.py, please edit CMakeLists.txt.in instead
# Generated from %WINE_GIT_VERSION%

project(apisets)

function (add_apiset apiset_name baseaddress)
    spec2def(${apiset_name}.dll ${apiset_name}.spec ADD_IMPORTLIB)

    add_definitions(
        -D_CTYPE_DISABLE_MACROS
        -D_NO_INLINING
        -D__CRT__NO_INLINE
        -D__STDC_WANT_SECURE_LIB__=0
        -D_INC_STRING
        -D_CTYPE_DEFINED
        -D_WCTYPE_DEFINED
        -D_CRT_ERRNO_DEFINED)

    add_library(${apiset_name} MODULE
        ${CMAKE_CURRENT_BINARY_DIR}/${apiset_name}_stubs.c
        ${CMAKE_CURRENT_BINARY_DIR}/${apiset_name}.def)

    add_dependencies(${apiset_name} xdk)
    set_module_type(${apiset_name} win32dll ENTRYPOINT 0 UNICODE IMAGEBASE ${baseaddress})

    if(NOT MSVC)
        target_compile_options(${apiset_name} PRIVATE -fno-builtin)
    else()
        target_compile_options(${apiset_name} PRIVATE /wd4026 /wd4273 /Oi-)
    endif()

    add_importlibs(${apiset_name} ${ARGN} ntdll)

    add_cd_file(TARGET ${apiset_name} DESTINATION reactos/winsxs/x86_reactos.apisets_6595b64144ccf1df_1.0.0.0_none_deadbeef FOR all)
endfunction()

add_cd_file(FILE ${CMAKE_CURRENT_SOURCE_DIR}/x86_reactos.apisets_6595b64144ccf1df_1.0.0.0_none_deadbeef.manifest DESTINATION reactos/winsxs/manifests FOR all)

# Apisets will be appended

